(function(g,c){typeof exports=="object"&&typeof module<"u"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):(g=typeof globalThis<"u"?globalThis:g||self,c(g.screenShot={}))})(this,function(g){"use strict";const c=(d,t={},a="")=>{const i=document.createElement(d);for(let r in t)i.setAttribute(r,t[r]);return i.innerHTML=a,i},b=(d,t)=>(document.getElementById(d)||document.getElementsByTagName("head")[0].prepend(c("STYLE",{type:"text/css"},t)),!0),u=function(d={}){let t,a,i,r;b("geocam-screenshot-button",`
  .geocam-screenshot-button {
       background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTQgNGgzbDItMmg2bDIgMmgzYTIgMiAwIDAgMSAyIDJ2MTJhMiAyIDAgMCAxLTIgMkg0YTIgMiAwIDAgMS0yLTJWNmEyIDIgMCAwIDEgMi0ybTggM2E1IDUgMCAwIDAtNSA1YTUgNSAwIDAgMCA1IDVhNSA1IDAgMCAwIDUtNWE1IDUgMCAwIDAtNS01bTAgMmEzIDMgMCAwIDEgMyAzYTMgMyAwIDAgMS0zIDNhMyAzIDAgMCAxLTMtM2EzIDMgMCAwIDEgMy0zIi8+PC9zdmc+');
    }
  .geocam-viewshot-button {
       background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTQgNWgzbDItMmg2bDIgMmgzYTIgMiAwIDAgMSAyIDJ2MTJhMiAyIDAgMCAxLTIgMkg0YTIgMiAwIDAgMS0yLTJWN2EyIDIgMCAwIDEgMi0ybTkuMDkgNC40NWwtMi4wNCAyLjczbDEuNTUgMi4wN2wtLjg3LjY2bC0yLjQ2LTMuMjdMNiAxNmgxMnoiLz48L3N2Zz4=');
    }
  `);const f=async l=>{const s=t.renderer.domElement;s.style.filter="invert(1)";const o=await new Promise(e=>s.toBlob(e)),n=[new ClipboardItem({[o.type]:o})];await navigator.clipboard.write(n),s.style.removeProperty("filter")},y=async l=>{document.body.style.filter="invert(1)";const s=t.renderer.domElement,o=s.getBoundingClientRect(),n=r.container.getBoundingClientRect(),e={top:Math.min(o.top,n.top),left:Math.min(o.left,n.left),bottom:Math.max(o.bottom,n.bottom),right:Math.max(o.right,n.right)};e.width=e.right-e.left,e.height=e.bottom-e.top;const m=document.createElement("canvas");m.width=e.width,m.height=e.height;const w=m.getContext("2d"),A=await r.takeScreenshot(),h=new Image;h.src=A.dataUrl,await new Promise(M=>{h.onload=M}),o.witdh>n.width||o.height>n.height?(w.drawImage(s,o.left-e.left,o.top-e.top),w.drawImage(h,n.left-e.left,n.top-e.top)):(w.drawImage(h,n.left-e.left,n.top-e.top),w.drawImage(s,o.left-e.left,o.top-e.top));const p=await new Promise(M=>m.toBlob(M)),D=[new ClipboardItem({[p.type]:p})];await navigator.clipboard.write(D),document.body.style.removeProperty("filter")};this.init=function(l){t=l,a=c("DIV",{class:"geocam-screenshot-button geocam-viewer-control-button",title:"Copy a screenshot of the current viewer image to the clipboard"}),t.addControl(a,"left-top"),a.addEventListener("click",f,!1)},this.arcgisView=function(l){console.log("screen shot add view",l),r||(r=l,i=c("DIV",{class:"geocam-viewshot-button geocam-viewer-control-button",title:"Copy a screenshot of the current viewer image and map to the clipboard"}),t.addControl(i,"left-top",{after:a}),i.addEventListener("click",y,!1))},this.destroy=function(){i&&t.wrapper.removeChild(i),t.wrapper.removeChild(a)}};class I extends HTMLElement{constructor(){super(),this.plugin=null,console.log("screen-shot init")}connectedCallback(){console.log("screen-shot connected");const t=this.parentNode;t.viewer&&t.viewer.plugin?(this.plugin=new u,t.viewer.plugin(this.plugin)):console.error("GeocamViewerScreenShot must be a child of GeocamViewer")}disconnectedCallback(){this.plugin=null,console.log("screen-shot disconnected")}}window.customElements.define("geocam-viewer-screen-shot",I),g.GeocamViewerScreenShot=I,Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});
